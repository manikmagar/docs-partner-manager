= Create a Map For Inbound EDIFACT to JSON or XML

Use the MuleSoft template named `Template to create inbound and outbound EDIFACT message transformation` to help you map EDI EDIFACT transactions to an application message format, such as JSON or XML.

This template uses the DataWeave to create the mapping between the inbound EDI EDIFACT transactions and the application format. It uses the application JSON or XML schema as input for the mapping.

To use the template to create the mapping:

. Create a project in Anypoint Studio based on the template.
. Set the source EDIFACT message type.
. Set the Target JSON or XML Message Type
. Test the map locally.

[[edifact-create-inound-project]]
== Create a Project From a Template

Create a template project in Anypoint Studio:

. Launch Anypoint Studio.
. From the *File* menu, select *New > Project from Template*.
. Log in to Anypoint Exchange with your Anypoint Platform credentials.
. Search for `edifact`.
. Click the template named `Template to create inbound and outbound EDIFACT message transformation`.
. Do either of the following:
* Click *Open*, to create a new project in your Studio workspace that is preloaded with the template.
* Download the template from Exchange and open the Mule configuration file `01-inbound-edifact-transform` in the downloaded template.

== Set the Source EDIFACT Message Type

The `01-inbound-edifact-transform.xml` template is configured with the EDIFACT version D97A, ORDERS message type. Follow these steps if you need to change the message type:

. From the Studio *Package Explorer*, select *00-global-configs.xml* in the *b2b-edifact-transform-template* project.
. In the Studio canvas, click the *Global Elements* tab.
. Select *EDIFACT_Read* and click *Edit*.
. In the *Value* field, select */edifact/d97a/ORDERS.esl* and click the edit icon.
. Change the schema value to the version and transaction set you want to map from.
+
For example, set *Value* to `/edifact/d96a/INVOIC.esl`, to map from the D96A Invoice message.
. Click *Finish*.

== Set the Target EDIFACT Message Type

Set the target message type to transform inbound EDI EDIFACT messages to your application message format:

. Copy the schema file of your target application message type into the `<Project-name>/src/main/resources` folder in the template project.
. From the *Mule Palette* view, click the *Transform Message* component and drag it on to the Studio canvas.
. Select the *Transform Message* component and in the *Output* section, click *Define metadata*.
+
image::partner-manager-inbound-map-1.png[Transform Message component add payload metadata]
. Click *Add*.
. In *Type id*, enter a new message type ID, for example `inbound-po`.
. Click *Create type*.
. From the *Type* drop-down menu in *Select metadata type*, select `JSON` or `XML`.
. Browse to the location of the JSON or XML schema file you imported in step 1 and click *Select*.
+
The new EDIFACT message structure displays in the Input pane, and your application message structure displays in the Output pane:
+
image
+
. Click the Edit current target icon:
+
image
+
. Select *File* and save the DataWeave map with a meaningful name, such as `INB-EDIFACT-D97A-ORDERS-to-Canonical-Purchase-Order-JSON.dwl`:
+
image
+
. Download an https://anypoint.mulesoft.com/exchange/works.integration/b2b-edifact-transform-demo/[sample] project from Exchange that has pre-built mapping to transform D97A ORDERS messages into a JSON application message structure.
////
Where do you find this?
////

== Test the Map Locally

Follow these steps to test the translation map locally in Anypoint Studio:

. In *Package Explorer*, right-click on the template project, and select *Run > Run as Mule application*.
. Use a REST client to post an EDI message payload to the URL `+http://localhost:8081/EDIFACT/inbound`.
+
The application returns the translated application message (JSON or XML) according to the mapping.
. After you verify that the map works correctly, copy the DataWeave map (dwl file) and import it in the Map section of your inbound EDIFACT message flow.

== See Also

* xref:configure-message-flows.adoc[Create and Configure an Inbound Message Flow]
